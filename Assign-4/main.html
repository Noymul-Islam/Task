<!DOCTYPE html>
<html>
<head>
	<title>Pagination</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body>
<div class="container">
<input type="text" id="taskName" placeholder="Add task...">
<input type="text" id="mentorName" placeholder="Mentor Name...">
<input type="date" id="deadLine" placeholder="DeadLine...">
<br>

<button id="addButton" class="btn" onclick="addTaskInfo()">Add To List</button>
  <table class="table">
  	<thead>
  		<tr>
  			<td>Task</td>
  			<td>Mentor</td>
  			<td>DeadLine</td>
  		</tr>
  	</thead>
  	<tbody id="tbody">
  		
  	</tbody>

  	
  </table>                  
  <ul class="pagination">

  </ul>	

</div>


</body>
<script type="text/javascript">
	var list=[];
    var startingPos=0;
    var pageAmount=0; 
    function taskObject(task,mentor,deadLine)
	{
		this.task=task;
		this.mentor= mentor;
		this.deadLine=deadLine;

	}
	/*here flag 0 means call for initialization and 1 means call for update*/
	function initUpdatePagination(flag)
	{
		if(!flag)
		{
			pageAmount=Math.ceil(list.length/5);
		}
		if(flag)
		{
		   var li= document.createElement('li');
		   var a= document.createElement('a');
		   var linkText=document.createTextNode(""+(pageAmount));
		   var pageNo=pageAmount;
		   a.appendChild(linkText);
		   a.addEventListener("click",function(){
			    	pageNumberClick(pageNo);
			    });
		   li.appendChild(a);
		   document.getElementsByClassName("pagination")[0].appendChild(li);
		   return;
		}
		for(let i=0;i<pageAmount;i++)
		{

			var li= document.createElement('li');
			var a= document.createElement('a');
			var linkText=document.createTextNode(""+(i+1));
			a.appendChild(linkText);
		    a.addEventListener("click",function(){
			    	pageNumberClick(i+1);
			    });
			li.appendChild(a);
			document.getElementsByClassName("pagination")[0].appendChild(li);
		}


	}
	function pageNumberClick(param)
	{
		//alert(param);
		startingPos=(param-1)*5;
		console.log(startingPos);
		showTaskList(startingPos);
	}
	function removeTableItem()
	{
		var parentNode = document.getElementById("tbody");
		//console.log(parentNode);
        while (parentNode.firstChild) 
         {
           parentNode.removeChild(parentNode.firstChild);
         }
	}
	function cellClick(id,updatedText)
	{
		
		let row = parseInt(id/10);
		let col=  id%10;
		    list= JSON.parse(localStorage.getItem("list"));
		let keys=Object.keys(list[row]);
		    list[row][keys[col]]=updatedText;
		    localStorage.removeItem("list");
		    localStorage.setItem("list",JSON.stringify(list));
		
	}
	function showTaskList(pos)
	{
		var substract=0;
		list= JSON.parse(localStorage.getItem("list"));
        if( Math.ceil(list.length/5)>pageAmount)
        {
        	pageAmount++;
        	initUpdatePagination(1);
        }
		removeTableItem();
		for(let i=pos; i<pos+5;i++)
		{
			if(list[i]!=undefined)
			{
		       var tbody = document.getElementById("tbody");
               let row   = tbody.insertRow(i-pos);
               let cell1 = row.insertCell(0);
               let cell2 = row.insertCell(1);
               let cell3 = row.insertCell(2);
               //let.id=i;
               cell1.id=i*10+0;
               cell2.id=i*10+1;
               cell3.id=i*10+2;
		       cell1.addEventListener("dblclick",function(){

		       	    let input=document.createElement("input");
		       	        input.setAttribute("type","text");
		       	        input.setAttribute("value",list[i].task);
		       	        cell1.innerHTML=null;
		       	        cell1.appendChild(input); 
		       	        input.addEventListener("blur",function(){
		       	       	      let updatedText= input.value;
                                  cell1.innerHTML=null; 
		       	       	          cell1.innerHTML= updatedText;

                             cellClick(cell1.id,updatedText);

		       	       }); 
			    	//cellClick(cell1.id);
			    });
		       cell2.addEventListener("dblclick",function(){
		       	   let input= document.createElement("input");
		       	       input.setAttribute("type","text");
		       	       input.setAttribute("value",list[i].mentor);
		       	       cell2.innerHTML=null;
		       	       cell2.appendChild(input);
		       	       input.addEventListener("blur",function(){
		       	       	      let updatedText= input.value;
                                  cell2.innerHTML=null; 
		       	       	          cell2.innerHTML= updatedText;

                             cellClick(cell2.id,updatedText);

		       	       });
			    	//cellClick(cell2.id);
			    });
		       cell3.addEventListener("dblclick",function(){
		       	  let input = document.createElement("input");
		       	      input.setAttribute("type","date");
		       	      input.setAttribute("value",list[i].deadLine);
		       	      cell3.innerHTML=null;
		       	      cell3.appendChild(input); 
		       	       input.addEventListener("blur",function(){
		       	       	      let updatedText= input.value;
                                  cell3.innerHTML=null; 
		       	       	          cell3.innerHTML= updatedText;

                             cellClick(cell3.id,updatedText);

		       	       });
			    	//cellClick(cell3.id);
			    });
               cell1.innerHTML = list[i].task;
               cell2.innerHTML = list[i].mentor;
               cell3.innerHTML = list[i].deadLine;
           }

       }


   }

	/* on page refrresh or load*/
	function onLoad()
	{

		list= JSON.parse(localStorage.getItem("list"));
		if(list==null|| list.length==0)
		{
			list=[];
			//localStorage.removeItem("list");
			localStorage.setItem("list",JSON.stringify(list));
		}
		else 
		{
			initUpdatePagination(0);
			showTaskList(startingPos);
		}


	}
	function addTaskInfo()
	{
		list= JSON.parse(localStorage.getItem("list"));
		var taskInput= document.getElementById("taskName").value; // input from task field
		var mentorName= document.getElementById("mentorName").value; // input from mentor field
		var deadLineTime= document.getElementById("deadLine").value;// input from date field
		document.getElementById("taskName").value="";
		document.getElementById("mentorName").value="";
		document.getElementById("deadLine").value="";
		if(taskInput==""||mentorName==""||deadLineTime=="")
		{
			alert("No Field should be empty");
		}
		else 
		{
		    var taskDetails= new taskObject(taskInput,mentorName,deadLineTime);
		    list.push(taskDetails);
		    localStorage.removeItem("list");
		    localStorage.setItem("list",JSON.stringify(list));
		    showTaskList(startingPos);
        }
	}


	onLoad();
	
</script>





  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</html>